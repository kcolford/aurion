#!/bin/sh
[ "$1" ] || exit
d="$(dirname "$1")"
b="$(basename "$1")"
case "$d" in
    aur|my-aur)
	git submodule deinit "$1"
	git rm -f "$1"
	;;
    *)
	rm -rf "$1"
	;;
esac

for repo in build/repo/*.db; do
    repo="$(readlink -e "$repo")" && repo-remove "$repo" "$b"
done
read -r url < global-url
rsync -lr --delete build/repo/ "$url"
